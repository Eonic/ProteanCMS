/**
 * Minified by jsDelivr using Terser v5.13.1.
 * Original file: /npm/@fancyapps/ui@4.0.27/src/Fancybox/Fancybox.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import{extend}from"../shared/utils/extend.js";import{canUseDOM}from"../shared/utils/canUseDOM.js";import{FOCUSABLE_ELEMENTS,setFocusOn}from"../shared/utils/setFocusOn.js";import{Base}from"../shared/Base/Base.js";import{Carousel}from"../Carousel/Carousel.js";import{Plugins}from"./plugins/index.js";import en from"./l10n/en.js";const defaults={startIndex:0,preload:1,infinite:!0,showClass:"fancybox-zoomInUp",hideClass:"fancybox-fadeOut",animated:!0,hideScrollbar:!0,parentEl:null,mainClass:null,autoFocus:!0,trapFocus:!0,placeFocusBack:!0,click:"close",closeButton:"inside",dragToClose:!0,keyboard:{Escape:"close",Delete:"close",Backspace:"close",PageUp:"next",PageDown:"prev",ArrowUp:"next",ArrowDown:"prev",ArrowRight:"next",ArrowLeft:"prev"},template:{closeButton:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" tabindex="-1"><path d="M20 20L4 4m16 0L4 20"/></svg>',spinner:'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="50" viewBox="25 25 50 50" tabindex="-1"><circle cx="50" cy="50" r="20"/></svg>',main:null},l10n:en},instances=new Map;let called=0;class Fancybox extends Base{constructor(t,e={}){t=t.map((t=>(t.width&&(t._width=t.width),t.height&&(t._height=t.height),t))),super(extend(!0,{},defaults,e)),this.bindHandlers(),this.state="init",this.setItems(t),this.attachPlugins(Fancybox.Plugins),this.trigger("init"),!0===this.option("hideScrollbar")&&this.hideScrollbar(),this.initLayout(),this.initCarousel(),this.attachEvents(),instances.set(this.id,this),this.trigger("prepare"),this.state="ready",this.trigger("ready"),this.$container.setAttribute("aria-hidden","false"),this.option("trapFocus")&&this.focus()}option(t,...e){const n=this.getSlide();let s=n?n[t]:void 0;return void 0!==s?("function"==typeof s&&(s=s.call(this,this,...e)),s):super.option(t,...e)}bindHandlers(){for(const t of["onMousedown","onKeydown","onClick","onFocus","onCreateSlide","onSettle","onTouchMove","onTouchEnd","onTransform"])this[t]=this[t].bind(this)}attachEvents(){document.addEventListener("mousedown",this.onMousedown),document.addEventListener("keydown",this.onKeydown,!0),this.option("trapFocus")&&document.addEventListener("focus",this.onFocus,!0),this.$container.addEventListener("click",this.onClick)}detachEvents(){document.removeEventListener("mousedown",this.onMousedown),document.removeEventListener("keydown",this.onKeydown,!0),document.removeEventListener("focus",this.onFocus,!0),this.$container.removeEventListener("click",this.onClick)}initLayout(){this.$root=this.option("parentEl")||document.body;let t=this.option("template.main");t&&(this.$root.insertAdjacentHTML("beforeend",this.localize(t)),this.$container=this.$root.querySelector(".fancybox__container")),this.$container||(this.$container=document.createElement("div"),this.$root.appendChild(this.$container)),this.$container.onscroll=()=>(this.$container.scrollLeft=0,!1),Object.entries({class:"fancybox__container",role:"dialog",tabIndex:"-1","aria-modal":"true","aria-hidden":"true","aria-label":this.localize("{{MODAL}}")}).forEach((t=>this.$container.setAttribute(...t))),this.option("animated")&&this.$container.classList.add("is-animated"),this.$backdrop=this.$container.querySelector(".fancybox__backdrop"),this.$backdrop||(this.$backdrop=document.createElement("div"),this.$backdrop.classList.add("fancybox__backdrop"),this.$container.appendChild(this.$backdrop)),this.$carousel=this.$container.querySelector(".fancybox__carousel"),this.$carousel||(this.$carousel=document.createElement("div"),this.$carousel.classList.add("fancybox__carousel"),this.$container.appendChild(this.$carousel)),this.$container.Fancybox=this,this.id=this.$container.getAttribute("id"),this.id||(this.id=this.options.id||++called,this.$container.setAttribute("id","fancybox-"+this.id));const e=this.option("mainClass");return e&&this.$container.classList.add(...e.split(" ")),document.documentElement.classList.add("with-fancybox"),this.trigger("initLayout"),this}setItems(t){const e=[];for(const n of t){const t=n.$trigger;if(t){const e=t.dataset||{};n.src=e.src||t.getAttribute("href")||n.src,n.type=e.type||n.type,!n.src&&t instanceof HTMLImageElement&&(n.src=t.currentSrc||n.$trigger.src)}let s=n.$thumb;if(!s){let t=n.$trigger&&n.$trigger.origTarget;t&&(s=t instanceof HTMLImageElement?t:t.querySelector("img:not([aria-hidden])")),!s&&n.$trigger&&(s=n.$trigger instanceof HTMLImageElement?n.$trigger:n.$trigger.querySelector("img:not([aria-hidden])"))}n.$thumb=s||null;let o=n.thumb;!o&&s&&(o=s.currentSrc||s.src,!o&&s.dataset&&(o=s.dataset.lazySrc||s.dataset.src)),o||"image"!==n.type||(o=n.src),n.thumb=o||null,n.caption=n.caption||"",e.push(n)}this.items=e}initCarousel(){return this.Carousel=new Carousel(this.$carousel,extend(!0,{},{prefix:"",classNames:{viewport:"fancybox__viewport",track:"fancybox__track",slide:"fancybox__slide"},textSelection:!0,preload:this.option("preload"),friction:.88,slides:this.items,initialPage:this.options.startIndex,slidesPerPage:1,infiniteX:this.option("infinite"),infiniteY:!0,l10n:this.option("l10n"),Dots:!1,Navigation:{classNames:{main:"fancybox__nav",button:"carousel__button",next:"is-next",prev:"is-prev"}},Panzoom:{textSelection:!0,panOnlyZoomed:()=>this.Carousel&&this.Carousel.pages&&this.Carousel.pages.length<2&&!this.option("dragToClose"),lockAxis:()=>{if(this.Carousel){let t="x";return this.option("dragToClose")&&(t+="y"),t}}},on:{"*":(t,...e)=>this.trigger(`Carousel.${t}`,...e),init:t=>this.Carousel=t,createSlide:this.onCreateSlide,settle:this.onSettle}},this.option("Carousel"))),this.option("dragToClose")&&this.Carousel.Panzoom.on({touchMove:this.onTouchMove,afterTransform:this.onTransform,touchEnd:this.onTouchEnd}),this.trigger("initCarousel"),this}onCreateSlide(t,e){let n=e.caption||"";if("function"==typeof this.options.caption&&(n=this.options.caption.call(this,this,this.Carousel,e)),"string"==typeof n&&n.length){const t=document.createElement("div"),s=`fancybox__caption_${this.id}_${e.index}`;t.className="fancybox__caption",t.innerHTML=n,t.setAttribute("id",s),e.$caption=e.$el.appendChild(t),e.$el.classList.add("has-caption"),e.$el.setAttribute("aria-labelledby",s)}}onSettle(){this.option("autoFocus")&&this.focus()}onFocus(t){this.focus(t)}onClick(t){if(t.defaultPrevented)return;let e=t.composedPath()[0];if(e.matches("[data-fancybox-close]"))return t.preventDefault(),void Fancybox.close(!1,t);if(e.matches("[data-fancybox-next]"))return t.preventDefault(),void Fancybox.next();if(e.matches("[data-fancybox-prev]"))return t.preventDefault(),void Fancybox.prev();if(e.matches(FOCUSABLE_ELEMENTS)||document.activeElement.blur(),e.closest(".fancybox__content"))return;if(getSelection().toString().length)return;if(!1===this.trigger("click",t))return;switch(this.option("click")){case"close":this.close();break;case"next":this.next()}}onTouchMove(){const t=this.getSlide().Panzoom;return!t||1===t.content.scale}onTouchEnd(t){const e=t.dragOffset.y;Math.abs(e)>=150||Math.abs(e)>=35&&t.dragOffset.time<350?(this.option("hideClass")&&(this.getSlide().hideClass="fancybox-throwOut"+(t.content.y<0?"Up":"Down")),this.close()):"y"===t.lockAxis&&t.panTo({y:0})}onTransform(t){if(this.$backdrop){const e=Math.abs(t.content.y),n=e<1?"":Math.max(.33,Math.min(1,1-e/t.content.fitHeight*1.5));this.$container.style.setProperty("--fancybox-ts",n?"0s":""),this.$container.style.setProperty("--fancybox-opacity",n)}}onMousedown(){"ready"===this.state&&document.body.classList.add("is-using-mouse")}onKeydown(t){if(Fancybox.getInstance().id!==this.id)return;document.body.classList.remove("is-using-mouse");const e=t.key,n=this.option("keyboard");if(!n||t.ctrlKey||t.altKey||t.shiftKey)return;const s=t.composedPath()[0],o=document.activeElement&&document.activeElement.classList,i=o&&o.contains("carousel__button");if("Escape"!==e&&!i){if(t.target.isContentEditable||-1!==["BUTTON","TEXTAREA","OPTION","INPUT","SELECT","VIDEO"].indexOf(s.nodeName))return}if(!1===this.trigger("keydown",e,t))return;const a=n[e];"function"==typeof this[a]&&this[a]()}getSlide(){const t=this.Carousel;if(!t)return null;const e=null===t.page?t.option("initialPage"):t.page,n=t.pages||[];return n.length&&n[e]?n[e].slides[0]:null}focus(t){if(Fancybox.ignoreFocusChange)return;if(["init","closing","customClosing","destroy"].indexOf(this.state)>-1)return;const e=this.$container,n=this.getSlide(),s="done"===n.state?n.$el:null;if(s&&s.contains(document.activeElement))return;t&&t.preventDefault(),Fancybox.ignoreFocusChange=!0;const o=Array.from(e.querySelectorAll(FOCUSABLE_ELEMENTS));let i,a=[];for(let t of o){const e=t.offsetParent,n=s&&s.contains(t),o=!this.Carousel.$viewport.contains(t);e&&(n||o)?(a.push(t),void 0!==t.dataset.origTabindex&&(t.tabIndex=t.dataset.origTabindex,t.removeAttribute("data-orig-tabindex")),(t.hasAttribute("autoFocus")||!i&&n&&!t.classList.contains("carousel__button"))&&(i=t)):(t.dataset.origTabindex=void 0===t.dataset.origTabindex?t.getAttribute("tabindex"):t.dataset.origTabindex,t.tabIndex=-1)}t?a.indexOf(t.target)>-1?this.lastFocus=t.target:this.lastFocus===e?setFocusOn(a[a.length-1]):setFocusOn(e):this.option("autoFocus")&&i?setFocusOn(i):a.indexOf(document.activeElement)<0&&setFocusOn(e),this.lastFocus=document.activeElement,Fancybox.ignoreFocusChange=!1}hideScrollbar(){if(!canUseDOM)return;const t=window.innerWidth-document.documentElement.getBoundingClientRect().width,e="fancybox-style-noscroll";let n=document.getElementById(e);n||t>0&&(n=document.createElement("style"),n.id=e,n.type="text/css",n.innerHTML=`.compensate-for-scrollbar {padding-right: ${t}px;}`,document.getElementsByTagName("head")[0].appendChild(n),document.body.classList.add("compensate-for-scrollbar"))}revealScrollbar(){document.body.classList.remove("compensate-for-scrollbar");const t=document.getElementById("fancybox-style-noscroll");t&&t.remove()}clearContent(t){this.Carousel.trigger("removeSlide",t),t.$content&&(t.$content.remove(),t.$content=null),t.$closeButton&&(t.$closeButton.remove(),t.$closeButton=null),t._className&&t.$el.classList.remove(t._className)}setContent(t,e,n={}){let s;const o=t.$el;if(e instanceof HTMLElement)["img","iframe","video","audio"].indexOf(e.nodeName.toLowerCase())>-1?(s=document.createElement("div"),s.appendChild(e)):s=e;else{const t=document.createRange().createContextualFragment(e);s=document.createElement("div"),s.appendChild(t)}if(t.filter&&!t.error&&(s=s.querySelector(t.filter)),s instanceof Element)return t._className=`has-${n.suffix||t.type||"unknown"}`,o.classList.add(t._className),s.classList.add("fancybox__content"),"none"!==s.style.display&&"none"!==getComputedStyle(s).getPropertyValue("display")||(s.style.display=t.display||this.option("defaultDisplay")||"flex"),t.id&&s.setAttribute("id",t.id),t.$content=s,o.prepend(s),this.manageCloseButton(t),"loading"!==t.state&&this.revealContent(t),s;this.setError(t,"{{ELEMENT_NOT_FOUND}}")}manageCloseButton(t){const e=void 0===t.closeButton?this.option("closeButton"):t.closeButton;if(!e||"top"===e&&this.$closeButton)return;const n=document.createElement("button");n.classList.add("carousel__button","is-close"),n.setAttribute("title",this.options.l10n.CLOSE),n.innerHTML=this.option("template.closeButton"),n.addEventListener("click",(t=>this.close(t))),"inside"===e?(t.$closeButton&&t.$closeButton.remove(),t.$closeButton=t.$content.appendChild(n)):this.$closeButton=this.$container.insertBefore(n,this.$container.firstChild)}revealContent(t){this.trigger("reveal",t),t.$content.style.visibility="";let e=!1;t.error||"loading"===t.state||null!==this.Carousel.prevPage||t.index!==this.options.startIndex||(e=void 0===t.showClass?this.option("showClass"):t.showClass),e?(t.state="animating",this.animateCSS(t.$content,e,(()=>{this.done(t)}))):this.done(t)}animateCSS(t,e,n){if(t&&t.dispatchEvent(new CustomEvent("animationend",{bubbles:!0,cancelable:!0})),!t||!e)return void("function"==typeof n&&n());const s=function(o){o.currentTarget===this&&(t.removeEventListener("animationend",s),n&&n(),t.classList.remove(e))};t.addEventListener("animationend",s),t.classList.add(e)}done(t){t.state="done",this.trigger("done",t);const e=this.getSlide();e&&t.index===e.index&&this.option("autoFocus")&&this.focus()}setError(t,e){t.error=e,this.hideLoading(t),this.clearContent(t);const n=document.createElement("div");n.classList.add("fancybox-error"),n.innerHTML=this.localize(e||"<p>{{ERROR}}</p>"),this.setContent(t,n,{suffix:"error"})}showLoading(t){t.state="loading",t.$el.classList.add("is-loading");let e=t.$el.querySelector(".fancybox__spinner");e||(e=document.createElement("div"),e.classList.add("fancybox__spinner"),e.innerHTML=this.option("template.spinner"),e.addEventListener("click",(()=>{this.Carousel.Panzoom.velocity||this.close()})),t.$el.prepend(e))}hideLoading(t){const e=t.$el&&t.$el.querySelector(".fancybox__spinner");e&&(e.remove(),t.$el.classList.remove("is-loading")),"loading"===t.state&&(this.trigger("load",t),t.state="ready")}next(){const t=this.Carousel;t&&t.pages.length>1&&t.slideNext()}prev(){const t=this.Carousel;t&&t.pages.length>1&&t.slidePrev()}jumpTo(...t){this.Carousel&&this.Carousel.slideTo(...t)}close(t){if(t&&t.preventDefault(),["closing","customClosing","destroy"].includes(this.state))return;if(!1===this.trigger("shouldClose",t))return;if(this.state="closing",this.Carousel.Panzoom.destroy(),this.detachEvents(),this.trigger("closing",t),"destroy"===this.state)return;this.$container.setAttribute("aria-hidden","true"),this.$container.classList.add("is-closing");const e=this.getSlide();if(this.Carousel.slides.forEach((t=>{t.$content&&t.index!==e.index&&this.Carousel.trigger("removeSlide",t)})),"closing"===this.state){const t=void 0===e.hideClass?this.option("hideClass"):e.hideClass;this.animateCSS(e.$content,t,(()=>{this.destroy()}),!0)}}destroy(){if("destroy"===this.state)return;this.state="destroy",this.trigger("destroy");const t=this.option("placeFocusBack")?this.getSlide().$trigger:null;this.Carousel.destroy(),this.detachPlugins(),this.Carousel=null,this.options={},this.events={},this.$container.remove(),this.$container=this.$backdrop=this.$carousel=null,t&&setFocusOn(t),instances.delete(this.id);const e=Fancybox.getInstance();e?e.focus():(document.documentElement.classList.remove("with-fancybox"),document.body.classList.remove("is-using-mouse"),this.revealScrollbar())}static show(t,e={}){return new Fancybox(t,e)}static fromEvent(t,e={}){if(t.defaultPrevented)return;if(t.button&&0!==t.button)return;if(t.ctrlKey||t.metaKey||t.shiftKey)return;const n=t.composedPath()[0];let s,o,i,a=n;if((a.matches("[data-fancybox-trigger]")||(a=a.closest("[data-fancybox-trigger]")))&&(s=a&&a.dataset&&a.dataset.fancyboxTrigger),s){const t=document.querySelectorAll(`[data-fancybox="${s}"]`),e=parseInt(a.dataset.fancyboxIndex,10)||0;a=t.length?t[e]:a}a||(a=n),Array.from(Fancybox.openers.keys()).reverse().some((e=>{i=a;let n=!1;try{i instanceof Element&&("string"==typeof e||e instanceof String)&&(n=i.matches(e)||(i=i.closest(e)))}catch(t){}return!!n&&(t.preventDefault(),o=e,!0)}));let r=!1;if(o){e.event=t,e.target=i,i.origTarget=n,r=Fancybox.fromOpener(o,e);const s=Fancybox.getInstance();s&&"ready"===s.state&&t.detail&&document.body.classList.add("is-using-mouse")}return r}static fromOpener(t,e={}){let n=[],s=e.startIndex||0,o=e.target||null;const i=void 0!==(e=extend({},e,Fancybox.openers.get(t))).groupAll&&e.groupAll,a=void 0===e.groupAttr?"data-fancybox":e.groupAttr,r=a&&o?o.getAttribute(`${a}`):"";if(!o||r||i){const s=e.root||(o?o.getRootNode():document.body);n=[].slice.call(s.querySelectorAll(t))}if(o&&!i&&(n=r?n.filter((t=>t.getAttribute(`${a}`)===r)):[o]),!n.length)return!1;const c=Fancybox.getInstance();return!(c&&n.indexOf(c.options.$trigger)>-1)&&(s=o?n.indexOf(o):s,n=n.map((function(t){const e=["false","0","no","null","undefined"],n=["true","1","yes"],s=Object.assign({},t.dataset),o={};for(let[t,i]of Object.entries(s))if("fancybox"!==t)if("width"===t||"height"===t)o[`_${t}`]=i;else if("string"==typeof i||i instanceof String)if(e.indexOf(i)>-1)o[t]=!1;else if(n.indexOf(o[t])>-1)o[t]=!0;else try{o[t]=JSON.parse(i)}catch(e){o[t]=i}else o[t]=i;return t instanceof Element&&(o.$trigger=t),o})),new Fancybox(n,extend({},e,{startIndex:s,$trigger:o})))}static bind(t,e={}){function n(){document.body.addEventListener("click",Fancybox.fromEvent,!1)}canUseDOM&&(Fancybox.openers.size||(/complete|interactive|loaded/.test(document.readyState)?n():document.addEventListener("DOMContentLoaded",n)),Fancybox.openers.set(t,e))}static unbind(t){Fancybox.openers.delete(t),Fancybox.openers.size||Fancybox.destroy()}static destroy(){let t;for(;t=Fancybox.getInstance();)t.destroy();Fancybox.openers=new Map,document.body.removeEventListener("click",Fancybox.fromEvent,!1)}static getInstance(t){if(t)return instances.get(t);return Array.from(instances.values()).reverse().find((t=>!["closing","customClosing","destroy"].includes(t.state)&&t))||null}static close(t=!0,e){if(t)for(const t of instances.values())t.close(e);else{const t=Fancybox.getInstance();t&&t.close(e)}}static next(){const t=Fancybox.getInstance();t&&t.next()}static prev(){const t=Fancybox.getInstance();t&&t.prev()}}Fancybox.version="__VERSION__",Fancybox.defaults=defaults,Fancybox.openers=new Map,Fancybox.Plugins=Plugins,Fancybox.bind("[data-fancybox]");for(const[t,e]of Object.entries(Fancybox.Plugins||{}))"function"==typeof e.create&&e.create(Fancybox);export{Fancybox};
//# sourceMappingURL=/sm/30ff2ed617f4cc351e82019537b0081eb63fba60e1fcba7a49d4939b5bcaff96.map