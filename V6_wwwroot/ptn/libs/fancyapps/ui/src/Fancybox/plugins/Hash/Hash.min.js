/**
 * Minified by jsDelivr using Terser v5.19.2.
 * Original file: /npm/@fancyapps/ui@4.0.27/src/Fancybox/plugins/Hash/Hash.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import{canUseDOM}from"../../../shared/utils/canUseDOM.js";export class Hash{constructor(t){this.fancybox=t;for(const t of["onChange","onClosing"])this[t]=this[t].bind(this);this.events={initCarousel:this.onChange,"Carousel.change":this.onChange,closing:this.onClosing},this.hasCreatedHistory=!1,this.origHash="",this.timer=null}onChange(t){const e=t.Carousel;this.timer&&clearTimeout(this.timer);const s=null===e.prevPage,n=t.getSlide(),a=new URL(document.URL).hash;let i=!1;if(n.slug)i="#"+n.slug;else{const s=n.$trigger&&n.$trigger.dataset,a=t.option("slug")||s&&s.fancybox;a&&a.length&&"true"!==a&&(i="#"+a+(e.slides.length>1?"-"+(n.index+1):""))}s&&(this.origHash=a!==i?a:""),i&&a!==i&&(this.timer=setTimeout((()=>{try{window.history[s?"pushState":"replaceState"]({},document.title,window.location.pathname+window.location.search+i),s&&(this.hasCreatedHistory=!0)}catch(t){}}),300))}onClosing(){if(this.timer&&clearTimeout(this.timer),!0!==this.hasSilentClose)try{return void window.history.replaceState({},document.title,window.location.pathname+window.location.search+(this.origHash||""))}catch(t){}}attach(t){t.on(this.events)}detach(t){t.off(this.events)}static startFromUrl(){const t=Hash.Fancybox;if(!t||t.getInstance()||!1===t.defaults.Hash)return;const{hash:e,slug:s,index:n}=Hash.getParsedURL();if(!s)return;let a=document.querySelector(`[data-slug="${e}"]`);if(a&&a.dispatchEvent(new CustomEvent("click",{bubbles:!0,cancelable:!0})),t.getInstance())return;const i=document.querySelectorAll(`[data-fancybox="${s}"]`);i.length&&(null===n&&1===i.length?a=i[0]:n&&(a=i[n-1]),a&&a.dispatchEvent(new CustomEvent("click",{bubbles:!0,cancelable:!0})))}static onHashChange(){const{slug:t,index:e}=Hash.getParsedURL(),s=Hash.Fancybox,n=s&&s.getInstance();if(n&&n.plugins.Hash){if(t){const s=n.Carousel;if(t===n.option("slug"))return s.slideTo(e-1);for(let e of s.slides)if(e.slug&&e.slug===t)return s.slideTo(e.index);const a=n.getSlide(),i=a.$trigger&&a.$trigger.dataset;if(i&&i.fancybox===t)return s.slideTo(e-1)}n.plugins.Hash.hasSilentClose=!0,n.close()}Hash.startFromUrl()}static create(t){function e(){window.addEventListener("hashchange",Hash.onHashChange,!1),Hash.startFromUrl()}Hash.Fancybox=t,canUseDOM&&window.requestAnimationFrame((()=>{/complete|interactive|loaded/.test(document.readyState)?e():document.addEventListener("DOMContentLoaded",e)}))}static destroy(){window.removeEventListener("hashchange",Hash.onHashChange,!1)}static getParsedURL(){const t=window.location.hash.substr(1),e=t.split("-"),s=e.length>1&&/^\+?\d+$/.test(e[e.length-1])&&parseInt(e.pop(-1),10)||null;return{hash:t,slug:e.join("-"),index:s}}}
//# sourceMappingURL=/sm/2b81acb08cdd7c8a940a79144f0bca2434468f1c13016a6fb8458dc97fd82fda.map