/**
 * Minified by jsDelivr using Terser v5.17.1.
 * Original file: /npm/leaflet@1.9.4/src/map/handler/Map.Drag.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import{Map}from"../Map";import{Handler}from"../../core/Handler";import{Draggable}from"../../dom/Draggable";import*as Util from"../../core/Util";import*as DomUtil from"../../dom/DomUtil";import{toLatLngBounds as latLngBounds}from"../../geo/LatLngBounds";import{toBounds}from"../../geometry/Bounds";Map.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});export var Drag=Handler.extend({addHooks:function(){if(!this._draggable){var i=this._map;this._draggable=new Draggable(i._mapPane,i._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),i.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),i.on("zoomend",this._onZoomEnd,this),i.whenReady(this._onZoomEnd,this))}DomUtil.addClass(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){DomUtil.removeClass(this._map._container,"leaflet-grab"),DomUtil.removeClass(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var i=this._map;if(i._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var t=latLngBounds(this._map.options.maxBounds);this._offsetLimit=toBounds(this._map.latLngToContainerPoint(t.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(t.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;i.fire("movestart").fire("dragstart"),i.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(i){if(this._map.options.inertia){var t=this._lastTime=+new Date,s=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(s),this._times.push(t),this._prunePositions(t)}this._map.fire("move",i).fire("drag",i)},_prunePositions:function(i){for(;this._positions.length>1&&i-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var i=this._map.getSize().divideBy(2),t=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=t.subtract(i).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(i,t){return i-(i-t)*this._viscosity},_onPreDragLimit:function(){if(this._viscosity&&this._offsetLimit){var i=this._draggable._newPos.subtract(this._draggable._startPos),t=this._offsetLimit;i.x<t.min.x&&(i.x=this._viscousLimit(i.x,t.min.x)),i.y<t.min.y&&(i.y=this._viscousLimit(i.y,t.min.y)),i.x>t.max.x&&(i.x=this._viscousLimit(i.x,t.max.x)),i.y>t.max.y&&(i.y=this._viscousLimit(i.y,t.max.y)),this._draggable._newPos=this._draggable._startPos.add(i)}},_onPreDragWrap:function(){var i=this._worldWidth,t=Math.round(i/2),s=this._initialWorldOffset,a=this._draggable._newPos.x,o=(a-t+s)%i+t-s,e=(a+t+s)%i-t-s,n=Math.abs(o+s)<Math.abs(e+s)?o:e;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=n},_onDragEnd:function(i){var t=this._map,s=t.options,a=!s.inertia||i.noInertia||this._times.length<2;if(t.fire("dragend",i),a)t.fire("moveend");else{this._prunePositions(+new Date);var o=this._lastPos.subtract(this._positions[0]),e=(this._lastTime-this._times[0])/1e3,n=s.easeLinearity,r=o.multiplyBy(n/e),_=r.distanceTo([0,0]),m=Math.min(s.inertiaMaxSpeed,_),h=r.multiplyBy(m/_),g=m/(s.inertiaDeceleration*n),d=h.multiplyBy(-g/2).round();d.x||d.y?(d=t._limitOffset(d,t.options.maxBounds),Util.requestAnimFrame((function(){t.panBy(d,{duration:g,easeLinearity:n,noMoveStart:!0,animate:!0})}))):t.fire("moveend")}}});Map.addInitHook("addHandler","dragging",Drag);
//# sourceMappingURL=/sm/9e9e7a08d1a9699d626567be8f260e6ed7423341c636b9040d3d74794a7b982a.map