/**
 * Minified by jsDelivr using Terser v5.17.1.
 * Original file: /npm/leaflet@1.9.4/src/map/handler/Map.TouchZoom.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import{Map}from"../Map";import{Handler}from"../../core/Handler";import*as DomEvent from"../../dom/DomEvent";import*as Util from"../../core/Util";import*as DomUtil from"../../dom/DomUtil";import Browser from"../../core/Browser";Map.mergeOptions({touchZoom:Browser.touch,bounceAtZoomLimits:!0});export var TouchZoom=Handler.extend({addHooks:function(){DomUtil.addClass(this._map._container,"leaflet-touch-zoom"),DomEvent.on(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){DomUtil.removeClass(this._map._container,"leaflet-touch-zoom"),DomEvent.off(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(o){var t=this._map;if(o.touches&&2===o.touches.length&&!t._animatingZoom&&!this._zooming){var i=t.mouseEventToContainerPoint(o.touches[0]),e=t.mouseEventToContainerPoint(o.touches[1]);this._centerPoint=t.getSize()._divideBy(2),this._startLatLng=t.containerPointToLatLng(this._centerPoint),"center"!==t.options.touchZoom&&(this._pinchStartLatLng=t.containerPointToLatLng(i.add(e)._divideBy(2))),this._startDist=i.distanceTo(e),this._startZoom=t.getZoom(),this._moved=!1,this._zooming=!0,t._stop(),DomEvent.on(document,"touchmove",this._onTouchMove,this),DomEvent.on(document,"touchend touchcancel",this._onTouchEnd,this),DomEvent.preventDefault(o)}},_onTouchMove:function(o){if(o.touches&&2===o.touches.length&&this._zooming){var t=this._map,i=t.mouseEventToContainerPoint(o.touches[0]),e=t.mouseEventToContainerPoint(o.touches[1]),n=i.distanceTo(e)/this._startDist;if(this._zoom=t.getScaleZoom(n,this._startZoom),!t.options.bounceAtZoomLimits&&(this._zoom<t.getMinZoom()&&n<1||this._zoom>t.getMaxZoom()&&n>1)&&(this._zoom=t._limitZoom(this._zoom)),"center"===t.options.touchZoom){if(this._center=this._startLatLng,1===n)return}else{var s=i._add(e)._divideBy(2)._subtract(this._centerPoint);if(1===n&&0===s.x&&0===s.y)return;this._center=t.unproject(t.project(this._pinchStartLatLng,this._zoom).subtract(s),this._zoom)}this._moved||(t._moveStart(!0,!1),this._moved=!0),Util.cancelAnimFrame(this._animRequest);var m=Util.bind(t._move,t,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=Util.requestAnimFrame(m,this,!0),DomEvent.preventDefault(o)}},_onTouchEnd:function(){this._moved&&this._zooming?(this._zooming=!1,Util.cancelAnimFrame(this._animRequest),DomEvent.off(document,"touchmove",this._onTouchMove,this),DomEvent.off(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))):this._zooming=!1}});Map.addInitHook("addHandler","touchZoom",TouchZoom);
//# sourceMappingURL=/sm/0c2320e897b4b8f0f3ed12014dfb04b7e0fbadd8f0b8414b7b8985f37348b00d.map