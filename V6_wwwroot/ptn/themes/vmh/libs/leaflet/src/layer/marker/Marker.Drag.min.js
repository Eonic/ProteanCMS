/**
 * Minified by jsDelivr using Terser v5.17.1.
 * Original file: /npm/leaflet@1.9.4/src/layer/marker/Marker.Drag.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import{Handler}from"../../core/Handler";import*as DomUtil from"../../dom/DomUtil";import{Draggable}from"../../dom/Draggable";import{toBounds}from"../../geometry/Bounds";import{toPoint}from"../../geometry/Point";import{requestAnimFrame,cancelAnimFrame}from"../../core/Util";export var MarkerDrag=Handler.extend({initialize:function(a){this._marker=a},addHooks:function(){var a=this._marker._icon;this._draggable||(this._draggable=new Draggable(a,a,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),DomUtil.addClass(a,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&DomUtil.removeClass(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(a){var t=this._marker,r=t._map,i=this._marker.options.autoPanSpeed,e=this._marker.options.autoPanPadding,n=DomUtil.getPosition(t._icon),o=r.getPixelBounds(),s=r.getPixelOrigin(),m=toBounds(o.min._subtract(s).add(e),o.max._subtract(s).subtract(e));if(!m.contains(n)){var g=toPoint((Math.max(m.max.x,n.x)-m.max.x)/(o.max.x-m.max.x)-(Math.min(m.min.x,n.x)-m.min.x)/(o.min.x-m.min.x),(Math.max(m.max.y,n.y)-m.max.y)/(o.max.y-m.max.y)-(Math.min(m.min.y,n.y)-m.min.y)/(o.min.y-m.min.y)).multiplyBy(i);r.panBy(g,{animate:!1}),this._draggable._newPos._add(g),this._draggable._startPos._add(g),DomUtil.setPosition(t._icon,this._draggable._newPos),this._onDrag(a),this._panRequest=requestAnimFrame(this._adjustPan.bind(this,a))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(a){this._marker.options.autoPan&&(cancelAnimFrame(this._panRequest),this._panRequest=requestAnimFrame(this._adjustPan.bind(this,a)))},_onDrag:function(a){var t=this._marker,r=t._shadow,i=DomUtil.getPosition(t._icon),e=t._map.layerPointToLatLng(i);r&&DomUtil.setPosition(r,i),t._latlng=e,a.latlng=e,a.oldLatLng=this._oldLatLng,t.fire("move",a).fire("drag",a)},_onDragEnd:function(a){cancelAnimFrame(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",a)}});
//# sourceMappingURL=/sm/0446bf6cd3ffd23e1253aa4e25e842d63f0e87435af70b846e0a93a1e0a45b15.map