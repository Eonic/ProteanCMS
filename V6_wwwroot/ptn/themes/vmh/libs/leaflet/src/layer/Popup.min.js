/**
 * Minified by jsDelivr using Terser v5.17.1.
 * Original file: /npm/leaflet@1.9.4/src/layer/Popup.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import{DivOverlay}from"./DivOverlay";import*as DomEvent from"../dom/DomEvent";import*as DomUtil from"../dom/DomUtil";import{Point,toPoint}from"../geometry/Point";import{Map}from"../map/Map";import{Layer}from"./Layer";import{Path}from"./vector/Path";import{FeatureGroup}from"./FeatureGroup";export var Popup=DivOverlay.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(t){return!(t=arguments.length?t:this._source._map).hasLayer(this)&&t._popup&&t._popup.options.autoClose&&t.removeLayer(t._popup),t._popup=this,DivOverlay.prototype.openOn.call(this,t)},onAdd:function(t){DivOverlay.prototype.onAdd.call(this,t),t.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof Path||this._source.on("preclick",DomEvent.stopPropagation))},onRemove:function(t){DivOverlay.prototype.onRemove.call(this,t),t.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof Path||this._source.off("preclick",DomEvent.stopPropagation))},getEvents:function(){var t=DivOverlay.prototype.getEvents.call(this);return(void 0!==this.options.closeOnClick?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(t.preclick=this.close),this.options.keepInView&&(t.moveend=this._adjustPan),t},_initLayout:function(){var t="leaflet-popup",o=this._container=DomUtil.create("div",t+" "+(this.options.className||"")+" leaflet-zoom-animated"),i=this._wrapper=DomUtil.create("div",t+"-content-wrapper",o);if(this._contentNode=DomUtil.create("div",t+"-content",i),DomEvent.disableClickPropagation(o),DomEvent.disableScrollPropagation(this._contentNode),DomEvent.on(o,"contextmenu",DomEvent.stopPropagation),this._tipContainer=DomUtil.create("div",t+"-tip-container",o),this._tip=DomUtil.create("div",t+"-tip",this._tipContainer),this.options.closeButton){var p=this._closeButton=DomUtil.create("a",t+"-close-button",o);p.setAttribute("role","button"),p.setAttribute("aria-label","Close popup"),p.href="#close",p.innerHTML='<span aria-hidden="true">&#215;</span>',DomEvent.on(p,"click",(function(t){DomEvent.preventDefault(t),this.close()}),this)}},_updateLayout:function(){var t=this._contentNode,o=t.style;o.width="",o.whiteSpace="nowrap";var i=t.offsetWidth;i=Math.min(i,this.options.maxWidth),i=Math.max(i,this.options.minWidth),o.width=i+1+"px",o.whiteSpace="",o.height="";var p=t.offsetHeight,e=this.options.maxHeight,n="leaflet-popup-scrolled";e&&p>e?(o.height=e+"px",DomUtil.addClass(t,n)):DomUtil.removeClass(t,n),this._containerWidth=this._container.offsetWidth},_animateZoom:function(t){var o=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center),i=this._getAnchor();DomUtil.setPosition(this._container,o.add(i))},_adjustPan:function(){if(this.options.autoPan)if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning)this._autopanning=!1;else{var t=this._map,o=parseInt(DomUtil.getStyle(this._container,"marginBottom"),10)||0,i=this._container.offsetHeight+o,p=this._containerWidth,e=new Point(this._containerLeft,-i-this._containerBottom);e._add(DomUtil.getPosition(this._container));var n=t.layerPointToContainerPoint(e),s=toPoint(this.options.autoPanPadding),a=toPoint(this.options.autoPanPaddingTopLeft||s),r=toPoint(this.options.autoPanPaddingBottomRight||s),u=t.getSize(),h=0,c=0;n.x+p+r.x>u.x&&(h=n.x+p-u.x+r.x),n.x-h-a.x<0&&(h=n.x-a.x),n.y+i+r.y>u.y&&(c=n.y+i-u.y+r.y),n.y-c-a.y<0&&(c=n.y-a.y),(h||c)&&(this.options.keepInView&&(this._autopanning=!0),t.fire("autopanstart").panBy([h,c]))}},_getAnchor:function(){return toPoint(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}});export var popup=function(t,o){return new Popup(t,o)};Map.mergeOptions({closePopupOnClick:!0}),Map.include({openPopup:function(t,o,i){return this._initOverlay(Popup,t,o,i).openOn(this),this},closePopup:function(t){return(t=arguments.length?t:this._popup)&&t.close(),this}}),Layer.include({bindPopup:function(t,o){return this._popup=this._initOverlay(Popup,this._popup,t,o),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(t){return this._popup&&(this instanceof FeatureGroup||(this._popup._source=this),this._popup._prepareOpen(t||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return!!this._popup&&this._popup.isOpen()},setPopupContent:function(t){return this._popup&&this._popup.setContent(t),this},getPopup:function(){return this._popup},_openPopup:function(t){if(this._popup&&this._map){DomEvent.stop(t);var o=t.layer||t.target;this._popup._source!==o||o instanceof Path?(this._popup._source=o,this.openPopup(t.latlng)):this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(t.latlng)}},_movePopup:function(t){this._popup.setLatLng(t.latlng)},_onKeyPress:function(t){13===t.originalEvent.keyCode&&this._openPopup(t)}});
//# sourceMappingURL=/sm/a93dac65fbe57a10b87631ee5e840b9c52871b0f66a7874262b1df00262aa0c0.map