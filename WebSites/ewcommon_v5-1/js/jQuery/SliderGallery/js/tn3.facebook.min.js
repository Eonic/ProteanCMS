/*!
 * tn3 facebook plugin v1.4.0.93
 * http://tn3gallery.com/
 *
 * License
 * http://tn3gallery.com/license
 *
 * Date: 15 Feb, 2013 13:23:03 +0200
 */
(function(f){var h=f.fn.tn3.External;h.facebook=function(c,a){this.config=f.extend(false,{},h.facebook.config,c);this.extcon=a;this.init()};h.facebook.config={source:"albums",ID:"",params:{offset:0,limit:20},aparams:{offset:0,limit:50},albumInfo:{},thumbSize:"thumbnail",imageSize:"normal",imageTitle:"title"};h.facebook.prototype={config:null,extcon:null,init:function(){this.getAlbums()},getAlbums:function(){switch(this.config.source){case "albums":this.request(f.extend({},this.config.aparams),this.config.ID+
"/albums","albums");break;case "batch":break;default:var c={title:this.config.source,adata:{origin:"facebook"}};f.extend(c,this.config.albumInfo);this.extcon.setAlbumData([c])}},getImages:function(c,a){var b={},d;b=f.extend(b,this.config.params);b.fields="id,picture,source,height,width,images,link,icon,created_time,updated_time,name";switch(this.config.source){case "albums":d=c.id+"/photos";break;default:d=this.config.ID+"/photos"}this.request(b,d,c,a)},request:function(c,a,b,d){f.ajax({url:"http://graph.facebook.com/"+
a,type:"GET",dataType:"jsonp",cache:false,context:this,jsonp:"callback",success:function(g){typeof b=="string"?this.parseAlbums(b=="albums"?g.data:[g]):this.parsePhotos(g.data,d)},data:c})},parsePhotos:function(c,a){var b=[],d=this,g,e;f.each(c,function(j,i){g={raw:i};e=d.extcon.getAlbumData(a)[d.config.imageTitle];if(e==null)e=d.config.imageTitle;f.extend(g,{title:e,description:i.name,thumb:d.getImagePath("thumb",i),img:d.getImagePath("image",i)});b.push(g)});this.extcon.setImageData(b,a)},parseAlbums:function(c){var a=
[],b=this,d;f.each(c,function(g,e){if(!(e.count===undefined||e.count==0)){d={raw:e};f.extend(d,{title:e.name,description:e.description,from:e.from.name,thumb:b.getImagePath("album",e),adata:{id:e.id,origin:"facebook"}});a.push(d)}});this.extcon.setAlbumData(a)},getImagePath:function(c,a){var b;if(c=="album")return a.cover_photo===undefined?"http://graph.facebook.com/"+a.id+"/picture?type=album":"http://graph.facebook.com/"+a.cover_photo+"/picture?type=album";else{b=this.config[c+"Size"];if(typeof b==
"number")return a.images[b].source;else if(b=="original")return a.images[0].source;return"http://graph.facebook.com/"+a.id+"/picture?type="+b}}}})(jQuery);
