/**
 * Minified by jsDelivr using Terser v5.13.1.
 * Original file: /npm/swiper@8.1.6/modules/zoom/zoom.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import{getWindow}from"ssr-window";import $ from"../../shared/dom.js";import{getTranslate}from"../../shared/utils.js";export default function Zoom(e){let{swiper:t,extendParams:a,on:s,emit:r}=e;const o=getWindow();a({zoom:{enabled:!1,maxRatio:3,minRatio:1,toggle:!0,containerClass:"swiper-zoom-container",zoomedSlideClass:"swiper-slide-zoomed"}}),t.zoom={enabled:!1};let i,n,l,c=1,m=!1;const u={$slideEl:void 0,slideWidth:void 0,slideHeight:void 0,$imageEl:void 0,$imageWrapEl:void 0,maxRatio:3},d={isTouched:void 0,isMoved:void 0,currentX:void 0,currentY:void 0,minX:void 0,minY:void 0,maxX:void 0,maxY:void 0,width:void 0,height:void 0,startX:void 0,startY:void 0,touchesStart:{},touchesCurrent:{}},p={x:void 0,y:void 0,prevPositionX:void 0,prevPositionY:void 0,prevTime:void 0};let h=1;function g(e){if(e.targetTouches.length<2)return 1;const t=e.targetTouches[0].pageX,a=e.targetTouches[0].pageY,s=e.targetTouches[1].pageX,r=e.targetTouches[1].pageY;return Math.sqrt((s-t)**2+(r-a)**2)}function E(e){const a=t.support,s=t.params.zoom;if(n=!1,l=!1,!a.gestures){if("touchstart"!==e.type||"touchstart"===e.type&&e.targetTouches.length<2)return;n=!0,u.scaleStart=g(e)}u.$slideEl&&u.$slideEl.length||(u.$slideEl=$(e.target).closest(`.${t.params.slideClass}`),0===u.$slideEl.length&&(u.$slideEl=t.slides.eq(t.activeIndex)),u.$imageEl=u.$slideEl.find(`.${s.containerClass}`).eq(0).find("picture, img, svg, canvas, .swiper-zoom-target").eq(0),u.$imageWrapEl=u.$imageEl.parent(`.${s.containerClass}`),u.maxRatio=u.$imageWrapEl.attr("data-swiper-zoom")||s.maxRatio,0!==u.$imageWrapEl.length)?(u.$imageEl&&u.$imageEl.transition(0),m=!0):u.$imageEl=void 0}function v(e){const a=t.support,s=t.params.zoom,r=t.zoom;if(!a.gestures){if("touchmove"!==e.type||"touchmove"===e.type&&e.targetTouches.length<2)return;l=!0,u.scaleMove=g(e)}u.$imageEl&&0!==u.$imageEl.length?(a.gestures?r.scale=e.scale*c:r.scale=u.scaleMove/u.scaleStart*c,r.scale>u.maxRatio&&(r.scale=u.maxRatio-1+(r.scale-u.maxRatio+1)**.5),r.scale<s.minRatio&&(r.scale=s.minRatio+1-(s.minRatio-r.scale+1)**.5),u.$imageEl.transform(`translate3d(0,0,0) scale(${r.scale})`)):"gesturechange"===e.type&&E(e)}function f(e){const a=t.device,s=t.support,r=t.params.zoom,o=t.zoom;if(!s.gestures){if(!n||!l)return;if("touchend"!==e.type||"touchend"===e.type&&e.changedTouches.length<2&&!a.android)return;n=!1,l=!1}u.$imageEl&&0!==u.$imageEl.length&&(o.scale=Math.max(Math.min(o.scale,u.maxRatio),r.minRatio),u.$imageEl.transition(t.params.speed).transform(`translate3d(0,0,0) scale(${o.scale})`),c=o.scale,m=!1,1===o.scale&&(u.$slideEl=void 0))}function x(e){const a=t.zoom;if(!u.$imageEl||0===u.$imageEl.length)return;if(t.allowClick=!1,!d.isTouched||!u.$slideEl)return;d.isMoved||(d.width=u.$imageEl[0].offsetWidth,d.height=u.$imageEl[0].offsetHeight,d.startX=getTranslate(u.$imageWrapEl[0],"x")||0,d.startY=getTranslate(u.$imageWrapEl[0],"y")||0,u.slideWidth=u.$slideEl[0].offsetWidth,u.slideHeight=u.$slideEl[0].offsetHeight,u.$imageWrapEl.transition(0));const s=d.width*a.scale,r=d.height*a.scale;if(!(s<u.slideWidth&&r<u.slideHeight)){if(d.minX=Math.min(u.slideWidth/2-s/2,0),d.maxX=-d.minX,d.minY=Math.min(u.slideHeight/2-r/2,0),d.maxY=-d.minY,d.touchesCurrent.x="touchmove"===e.type?e.targetTouches[0].pageX:e.pageX,d.touchesCurrent.y="touchmove"===e.type?e.targetTouches[0].pageY:e.pageY,!d.isMoved&&!m){if(t.isHorizontal()&&(Math.floor(d.minX)===Math.floor(d.startX)&&d.touchesCurrent.x<d.touchesStart.x||Math.floor(d.maxX)===Math.floor(d.startX)&&d.touchesCurrent.x>d.touchesStart.x))return void(d.isTouched=!1);if(!t.isHorizontal()&&(Math.floor(d.minY)===Math.floor(d.startY)&&d.touchesCurrent.y<d.touchesStart.y||Math.floor(d.maxY)===Math.floor(d.startY)&&d.touchesCurrent.y>d.touchesStart.y))return void(d.isTouched=!1)}e.cancelable&&e.preventDefault(),e.stopPropagation(),d.isMoved=!0,d.currentX=d.touchesCurrent.x-d.touchesStart.x+d.startX,d.currentY=d.touchesCurrent.y-d.touchesStart.y+d.startY,d.currentX<d.minX&&(d.currentX=d.minX+1-(d.minX-d.currentX+1)**.8),d.currentX>d.maxX&&(d.currentX=d.maxX-1+(d.currentX-d.maxX+1)**.8),d.currentY<d.minY&&(d.currentY=d.minY+1-(d.minY-d.currentY+1)**.8),d.currentY>d.maxY&&(d.currentY=d.maxY-1+(d.currentY-d.maxY+1)**.8),p.prevPositionX||(p.prevPositionX=d.touchesCurrent.x),p.prevPositionY||(p.prevPositionY=d.touchesCurrent.y),p.prevTime||(p.prevTime=Date.now()),p.x=(d.touchesCurrent.x-p.prevPositionX)/(Date.now()-p.prevTime)/2,p.y=(d.touchesCurrent.y-p.prevPositionY)/(Date.now()-p.prevTime)/2,Math.abs(d.touchesCurrent.x-p.prevPositionX)<2&&(p.x=0),Math.abs(d.touchesCurrent.y-p.prevPositionY)<2&&(p.y=0),p.prevPositionX=d.touchesCurrent.x,p.prevPositionY=d.touchesCurrent.y,p.prevTime=Date.now(),u.$imageWrapEl.transform(`translate3d(${d.currentX}px, ${d.currentY}px,0)`)}}function X(){const e=t.zoom;u.$slideEl&&t.previousIndex!==t.activeIndex&&(u.$imageEl&&u.$imageEl.transform("translate3d(0,0,0) scale(1)"),u.$imageWrapEl&&u.$imageWrapEl.transform("translate3d(0,0,0)"),e.scale=1,c=1,u.$slideEl=void 0,u.$imageEl=void 0,u.$imageWrapEl=void 0)}function Y(e){const a=t.zoom,s=t.params.zoom;if(u.$slideEl||(e&&e.target&&(u.$slideEl=$(e.target).closest(`.${t.params.slideClass}`)),u.$slideEl||(t.params.virtual&&t.params.virtual.enabled&&t.virtual?u.$slideEl=t.$wrapperEl.children(`.${t.params.slideActiveClass}`):u.$slideEl=t.slides.eq(t.activeIndex)),u.$imageEl=u.$slideEl.find(`.${s.containerClass}`).eq(0).find("picture, img, svg, canvas, .swiper-zoom-target").eq(0),u.$imageWrapEl=u.$imageEl.parent(`.${s.containerClass}`)),!u.$imageEl||0===u.$imageEl.length||!u.$imageWrapEl||0===u.$imageWrapEl.length)return;let r,i,n,l,m,p,h,g,E,v,f,x,X,Y,w,z,C,y;t.params.cssMode&&(t.wrapperEl.style.overflow="hidden",t.wrapperEl.style.touchAction="none"),u.$slideEl.addClass(`${s.zoomedSlideClass}`),void 0===d.touchesStart.x&&e?(r="touchend"===e.type?e.changedTouches[0].pageX:e.pageX,i="touchend"===e.type?e.changedTouches[0].pageY:e.pageY):(r=d.touchesStart.x,i=d.touchesStart.y),a.scale=u.$imageWrapEl.attr("data-swiper-zoom")||s.maxRatio,c=u.$imageWrapEl.attr("data-swiper-zoom")||s.maxRatio,e?(C=u.$slideEl[0].offsetWidth,y=u.$slideEl[0].offsetHeight,n=u.$slideEl.offset().left+o.scrollX,l=u.$slideEl.offset().top+o.scrollY,m=n+C/2-r,p=l+y/2-i,E=u.$imageEl[0].offsetWidth,v=u.$imageEl[0].offsetHeight,f=E*a.scale,x=v*a.scale,X=Math.min(C/2-f/2,0),Y=Math.min(y/2-x/2,0),w=-X,z=-Y,h=m*a.scale,g=p*a.scale,h<X&&(h=X),h>w&&(h=w),g<Y&&(g=Y),g>z&&(g=z)):(h=0,g=0),u.$imageWrapEl.transition(300).transform(`translate3d(${h}px, ${g}px,0)`),u.$imageEl.transition(300).transform(`translate3d(0,0,0) scale(${a.scale})`)}function w(){const e=t.zoom,a=t.params.zoom;u.$slideEl||(t.params.virtual&&t.params.virtual.enabled&&t.virtual?u.$slideEl=t.$wrapperEl.children(`.${t.params.slideActiveClass}`):u.$slideEl=t.slides.eq(t.activeIndex),u.$imageEl=u.$slideEl.find(`.${a.containerClass}`).eq(0).find("picture, img, svg, canvas, .swiper-zoom-target").eq(0),u.$imageWrapEl=u.$imageEl.parent(`.${a.containerClass}`)),u.$imageEl&&0!==u.$imageEl.length&&u.$imageWrapEl&&0!==u.$imageWrapEl.length&&(t.params.cssMode&&(t.wrapperEl.style.overflow="",t.wrapperEl.style.touchAction=""),e.scale=1,c=1,u.$imageWrapEl.transition(300).transform("translate3d(0,0,0)"),u.$imageEl.transition(300).transform("translate3d(0,0,0) scale(1)"),u.$slideEl.removeClass(`${a.zoomedSlideClass}`),u.$slideEl=void 0)}function z(e){const a=t.zoom;a.scale&&1!==a.scale?w():Y(e)}function C(){const e=t.support;return{passiveListener:!("touchstart"!==t.touchEvents.start||!e.passiveListener||!t.params.passiveListeners)&&{passive:!0,capture:!1},activeListenerWithCapture:!e.passiveListener||{passive:!1,capture:!0}}}function y(){return`.${t.params.slideClass}`}function M(e){const{passiveListener:a}=C(),s=y();t.$wrapperEl[e]("gesturestart",s,E,a),t.$wrapperEl[e]("gesturechange",s,v,a),t.$wrapperEl[e]("gestureend",s,f,a)}function W(){i||(i=!0,M("on"))}function T(){i&&(i=!1,M("off"))}function b(){const e=t.zoom;if(e.enabled)return;e.enabled=!0;const a=t.support,{passiveListener:s,activeListenerWithCapture:r}=C(),o=y();a.gestures?(t.$wrapperEl.on(t.touchEvents.start,W,s),t.$wrapperEl.on(t.touchEvents.end,T,s)):"touchstart"===t.touchEvents.start&&(t.$wrapperEl.on(t.touchEvents.start,o,E,s),t.$wrapperEl.on(t.touchEvents.move,o,v,r),t.$wrapperEl.on(t.touchEvents.end,o,f,s),t.touchEvents.cancel&&t.$wrapperEl.on(t.touchEvents.cancel,o,f,s)),t.$wrapperEl.on(t.touchEvents.move,`.${t.params.zoom.containerClass}`,x,r)}function S(){const e=t.zoom;if(!e.enabled)return;const a=t.support;e.enabled=!1;const{passiveListener:s,activeListenerWithCapture:r}=C(),o=y();a.gestures?(t.$wrapperEl.off(t.touchEvents.start,W,s),t.$wrapperEl.off(t.touchEvents.end,T,s)):"touchstart"===t.touchEvents.start&&(t.$wrapperEl.off(t.touchEvents.start,o,E,s),t.$wrapperEl.off(t.touchEvents.move,o,v,r),t.$wrapperEl.off(t.touchEvents.end,o,f,s),t.touchEvents.cancel&&t.$wrapperEl.off(t.touchEvents.cancel,o,f,s)),t.$wrapperEl.off(t.touchEvents.move,`.${t.params.zoom.containerClass}`,x,r)}Object.defineProperty(t.zoom,"scale",{get:()=>h,set(e){if(h!==e){const t=u.$imageEl?u.$imageEl[0]:void 0,a=u.$slideEl?u.$slideEl[0]:void 0;r("zoomChange",e,t,a)}h=e}}),s("init",(()=>{t.params.zoom.enabled&&b()})),s("destroy",(()=>{S()})),s("touchStart",((e,a)=>{t.zoom.enabled&&function(e){const a=t.device;u.$imageEl&&0!==u.$imageEl.length&&(d.isTouched||(a.android&&e.cancelable&&e.preventDefault(),d.isTouched=!0,d.touchesStart.x="touchstart"===e.type?e.targetTouches[0].pageX:e.pageX,d.touchesStart.y="touchstart"===e.type?e.targetTouches[0].pageY:e.pageY))}(a)})),s("touchEnd",((e,a)=>{t.zoom.enabled&&function(){const e=t.zoom;if(!u.$imageEl||0===u.$imageEl.length)return;if(!d.isTouched||!d.isMoved)return d.isTouched=!1,void(d.isMoved=!1);d.isTouched=!1,d.isMoved=!1;let a=300,s=300;const r=p.x*a,o=d.currentX+r,i=p.y*s,n=d.currentY+i;0!==p.x&&(a=Math.abs((o-d.currentX)/p.x)),0!==p.y&&(s=Math.abs((n-d.currentY)/p.y));const l=Math.max(a,s);d.currentX=o,d.currentY=n;const c=d.width*e.scale,m=d.height*e.scale;d.minX=Math.min(u.slideWidth/2-c/2,0),d.maxX=-d.minX,d.minY=Math.min(u.slideHeight/2-m/2,0),d.maxY=-d.minY,d.currentX=Math.max(Math.min(d.currentX,d.maxX),d.minX),d.currentY=Math.max(Math.min(d.currentY,d.maxY),d.minY),u.$imageWrapEl.transition(l).transform(`translate3d(${d.currentX}px, ${d.currentY}px,0)`)}()})),s("doubleTap",((e,a)=>{!t.animating&&t.params.zoom.enabled&&t.zoom.enabled&&t.params.zoom.toggle&&z(a)})),s("transitionEnd",(()=>{t.zoom.enabled&&t.params.zoom.enabled&&X()})),s("slideChange",(()=>{t.zoom.enabled&&t.params.zoom.enabled&&t.params.cssMode&&X()})),Object.assign(t.zoom,{enable:b,disable:S,in:Y,out:w,toggle:z})}
//# sourceMappingURL=/sm/0f02db5fd722f118c4c427850e1e6299ebfe1a723c41becf27edca7bc9ed4c39.map